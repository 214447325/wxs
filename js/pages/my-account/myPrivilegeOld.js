function nowReceive(a){$.ajax({url:Setting.apiRoot1+"/u/getVipPrivilege.p2p",type:"post",dataType:"json",data:{userId:userId,loginToken:loginToken,privilegeId:a}}).done(function(a){$("#resmes").html(a.message),$(".alert-layer").css("display","flex")}).fail(function(){alert("网络链接失败")})}function goUse(a){window.location.href="../../pages/financing/regular.html"}function goWithdraw(a){window.location.href="rewardCenter.html"}function takeApart(a){$.ajax({url:Setting.apiRoot1+"/u/getVipPrivilege.p2p",type:"post",dataType:"json",data:{userId:userId,loginToken:loginToken,privilegeId:a}}).done(function(a){sessionStorage.setItem("userCouponId",a.data.userCouponId),sessionStorage.setItem("cashredAmt",a.data.couponAmt),cashredAmt=sessionStorage.getItem("cashredAmt"),$(".cashredAmt").html("￥"+cashredAmt),$(".red-layer").css("display","flex")}).fail(function(){alert("网络链接失败")})}var userCouponId,cashredAmt,userId=sessionStorage.getItem("uid"),loginToken=sessionStorage.getItem("loginToken"),$ui_dialog=$(".ui-dialog"),$btn_link=$(".btn-link",$ui_dialog),$btn_default=$(".btn-default",$ui_dialog);$(function(){var a,s,e,i,t,n,p,o,l,c=$(".couponList");if(!userId)return Common.toLogin(),!1;var d=doT.template(["{{~it :item:index}}","{{?item.awardCount != 0 && item.couponType != 3}}","{{?(item.status ==1 || item.status ==2) && (item.newOldVipFlag == 1 || (item.newOldVipFlag == 0 && item.vipPrivilegeCount <= 0))}}","{{?item.status ==2 && item.couponType !=4}}",'<div class="coupon setGray">',"{{??}}",'<div class="coupon">',"{{?}}",'<div class="detail">','<div class="inprods">',"{{?item.couponType ==1}}",'<span class="indata">{{=item.addRate}}%',"</span>",'<span class="intitle">天数加息券',"</span>","{{?}}","{{?item.couponType ==2}}",'<span class="indata">{{=item.addRate}}%',"</span>",'<span class="intitle">全程加息券',"</span>","{{?}}","{{?item.couponType ==3}}",'<span class="indata indataTwo">{{=item.voucherAmt}}元',"</span>",'<span class="intitle">体验金',"</span>","{{?}}","{{?item.couponType ==4}}","{{?item.status ==1 || item.status ==-1}}",'<span class="indata mycash indataTwo">￥?',"</span>","{{??}}",'<span class="indata mycash indataTwo">￥{{=item.rewardAmt}}',"</span>","{{?}}",'<span class="intitle">现金红包',"</span>","{{?}}","{{?item.couponType ==5}}",'<span class="indata indataTwo">￥{{=item.investCouponAmt}}',"</span>",'<span class="intitle">投资红包',"</span>","{{?}}","</div>",'<div class="cpinfo">',"{{?item.couponType ==1}}",'<span class="day"><span>加息天数：</span><span>{{=item.addDays}}</span>',"</span>",'<span class="application"><span>适用产品：</span><span>{{=item.fitProds}}</span>',"</span>","{{?item.status ==2}}",'<span class="awardAmount"><span>奖励张数：</span><span>{{=item.noUseCouponNum}}张</span>',"</span>","{{??}}",'<span class="awardAmount"><span>奖励张数：</span><span>{{=item.awardCount}}张</span>',"</span>","{{?}}","{{?}}","{{?item.couponType ==2}}",'<span class="day"><span>加息天数：</span><span>全程</span>',"</span>",'<span class="application"><span>适用产品：</span><span>{{=item.fitProds}}</span>',"</span>","{{?item.status ==2}}",'<span class="awardAmount"><span>奖励张数：</span><span>{{=item.noUseCouponNum}}张</span>',"</span>","{{??}}",'<span class="awardAmount"><span>奖励张数：</span><span>{{=item.awardCount}}张</span>',"</span>","{{?}}","{{?}}","{{?item.couponType ==3}}",'<span class="day"><span>使用规则：</span><span>{{=item.useRule}}</span>',"</span>",'<span class="application"><span>适用产品：</span><span>{{=item.fitProds}}</span>',"</span>",'<span class="application"><span>体验天数：</span><span>{{=item.addDays}}</span>',"</span>","{{?}}","{{?item.couponType ==4}}",'<span class="day"><span>使用规则：</span><span>{{=item.useRule}}</span>',"</span>","{{?}}","{{?item.couponType ==5}}",'<span class="day"><span>使用规则：</span><span>{{=item.useRule}}</span>',"</span>",'<span class="awardAmount"><span>适用产品：</span><span>{{=item.fitProds}}</span>',"</span>",'<span class="awardAmount"><span>奖励张数：</span><span>{{=item.awardCount}}张</span>',"</span>","{{?}}","</div>","</div>","{{?item.status ==1}}","{{?item.couponType ==1 || item.couponType ==2}}",'<div class="state statu03" onClick="nowReceive({{=item.vpId}})">',"<span>立<br />即<br />领<br />取","</span>","</div>","{{??item.couponType ==4}}",'<div class="state statu01" onClick="takeApart({{=item.vpId}})">',"<span>拆","</span>","</div>","{{??}}",'<div class="state statu01" onClick="nowReceive({{=item.vpId}})">',"<span>立<br />即<br />领<br />取","</span>","</div>","{{?}}","{{??item.status ==2}}","{{?item.couponType ==4}}",'<div class="state statu04" onClick="goWithdraw({{=item.vpId}})">',"<span>立<br />即<br />提<br />现","</span>","</div>","{{??}}",'<div class="state statu04" onClick="goUse({{=item.vpId}})">','<img src="../../images/pages/my-account3.0/exclusive/yilingqu.png" alt="" />',"</div>","{{?}}","{{?}}","</div>","{{??item.status ==3 || item.status ==-1 || (item.newOldVipFlag == 0 && item.vipPrivilegeCount > 0)}}","{{?item.status == -1 && (item.couponType == 4 || item.couponType == 5) && (item.newOldVipFlag == 0 && item.vipPrivilegeCount <= 0)}}",'<div class="coupon setGrayTwo">',"{{??}}",'<div class="coupon setGray setGrayTwo">',"{{?}}",'<div class="detail">','<div class="inprods">',"{{?item.couponType ==1}}",'<span class="indata">{{=item.addRate}}%',"</span>",'<span class="intitle">天数加息券',"</span>","{{?}}","{{?item.couponType ==2}}",'<span class="indata">{{=item.addRate}}%',"</span>",'<span class="intitle">全程加息券',"</span>","{{?}}","{{?item.couponType ==3}}",'<span class="indata indataTwo">{{=item.voucherAmt}}元',"</span>",'<span class="intitle">体验金',"</span>","{{?}}","{{?item.couponType ==4}}","{{?item.status ==1 || item.status ==-1}}",'<span class="indata mycash indataTwo">￥?',"</span>","{{??}}",'<span class="indata mycash indataTwo">￥{{=item.rewardAmt}}',"</span>","{{?}}",'<span class="intitle">现金红包',"</span>","{{?}}","{{?item.couponType ==5}}",'<span class="indata indataTwo">￥{{=item.investCouponAmt}}',"</span>",'<span class="intitle">投资红包',"</span>","{{?}}","</div>",'<div class="cpinfo">',"{{?item.couponType ==1}}",'<span class="day">加息天数：{{=item.addDays}}',"</span>",'<span class="application">适用产品：{{=item.fitProds}}',"</span>","{{?item.status ==2}}",'<span class="awardAmount">奖励张数：{{=item.noUseCouponNum}}张',"</span>","{{??}}",'<span class="awardAmount">奖励张数：{{=item.awardCount}}张',"</span>","{{?}}","{{?}}","{{?item.couponType ==2}}",'<span class="day">加息天数：全程',"</span>",'<span class="application">适用产品：{{=item.fitProds}}',"</span>","{{?item.status ==2}}",'<span class="awardAmount">奖励张数：{{=item.noUseCouponNum}}张',"</span>","{{??}}",'<span class="awardAmount">奖励张数：{{=item.awardCount}}张',"</span>","{{?}}","{{?}}","{{?item.couponType ==3}}",'<span class="day">使用规则：{{=item.useRule}}',"</span>",'<span class="application">适用产品：{{=item.fitProds}}',"</span>",'<span class="application">体验天数：{{=item.addDays}}',"</span>","{{?}}","{{?item.couponType ==4}}",'<span class="day">使用规则：{{=item.useRule}}',"</span>","{{?}}","{{?item.couponType ==5}}",'<span class="day">使用规则：{{=item.useRule}}',"</span>",'<span class="awardAmount">适用产品：{{=item.fitProds}}',"</span>",'<span class="awardAmount">奖励张数：{{=item.awardCount}}张',"</span>","{{?}}","</div>","</div>","{{?item.newOldVipFlag == 1 || (item.newOldVipFlag == 0 && item.vipPrivilegeCount <= 0)}}","{{?item.status ==3}}","{{?item.couponType ==4}}",'<div class="state statu02" >','<img src="../../images/pages/my-account3.0/exclusive/yitixian.png" alt="" />',"</div>","{{??}}",'<div class="state statu02" >','<img src="../../images/pages/my-account3.0/exclusive/yishiyong.png" alt="" />',"</div>","{{?}}","{{??item.status ==-1}}","{{?item.couponType ==4 || item.couponType ==5}}",'<div class="state statu02" >',"<span>不<br />可<br />用","</span>","</div>","{{??}}",'<div class="state statu02" >','<img src="../../images/pages/my-account3.0/exclusive/bukeling.png" alt="" />',"</div>","{{?}}","{{?}}","{{??}}",'<div class="state statu02" >','<img src="../../images/pages/my-account3.0/exclusive/bukeling.png" alt="" />',"</div>","{{?}}","</div>","{{?}}","{{?}}","{{~}}"].join("")),r=doT.template(["{{~it :item:index}}",'<div class="vipLeft">','<div class="vipLeftText">您已打败<span>{{=item.defeatPercent}}',"</span>%用户","</div>",'<img src="{{=item.img}}" alt="" class="vipLeftImg">','<div class="vip">等级说明',"</div>","</div>",'<div class="canvasFather">','<canvas id="vipMighty">',"</canvas>",'<div class="vipMightyText">','<div class="vipMightySon" >',"<span>威武值","</span>","<span >",'<img class="vwzinfo" src="../../images/pages/my-account3.0/exclusive/vnowhelp.png" alt="">',"</span>"," </div>","{{? item.powerValue < item.startValue}}",' <div  class="vipMightyValue" style="color:red;">{{=item.powerValue}}</div>',"{{??}}",' <div  class="vipMightyValue">{{=item.powerValue}}</div>',"{{?}}",'<div class="upgradeFather">','<span class="upgradeLeft">{{=item.startValue}}',"</span>",'{{? item.VIPFinish == "VIP11"}}','<div class="upgrade">继续提升<img src="../../images/pages/my-account3.0/exclusive/vup.png" alt="" style="width:0.2533rem;height:0.3466rem;margin-left:0.2133rem;">',"</div>","{{??}}",'<div class="upgrade">马上升级<img src="../../images/pages/my-account3.0/exclusive/vup.png" alt="" style="width:0.2533rem;height:0.3466rem;margin-left:0.2133rem;">',"</div>","{{?}}",'<span class="upgradeRight">{{=item.endValue}}',"</span>","</div>","</div>","</div>","{{? item.powerValue < item.startValue}}",'<div class="finghingValue reg" style="font-size:0.25rem;">您当前的威武值已低于','<span style="color:white;">{{=item.VIPFinish}}',"</span>等级要求，请于降级前",'<span class="upgrade white" style="font-size:0.3rem;background: transparent;background-size: contain; width: auto; height: auto; line-height: normal; margin-top: 0; display: inline; float: none;color:white; ">尽快投资',"</span>！ ","</div>",'{{?? item.powerValue >= item.startValue && item.VIPFinish != "VIP11"}}','<div class="finghingValue">距离',"<span>{{=item.VIPFinish}}","</span>等级还差","<span>{{=item.poor}}","</span>威武值 ","</div>",'{{?? item.powerValue >= item.startValue && item.VIPFinish == "VIP11"}}','<div class="finghingValue">您现在是最高级别，请保持',"<span>","</span>","{{?}}","{{~}}"].join("")),u=doT.template(["{{~it :item:index}}",'<div class="vipLeft">','<div class="vipLeftText">',"</div>",'<img src="{{=item.img}}" alt="" class="vipLeftImg">','<div class="vip" style="color:#fff;">等级说明',"</div>","</div>",'<div class="canvasFather vbefore">','<div class="vipMightyText vipMightyTextFinish">',' <div class="vipMightySon" >',"<span>所需威武值","</span>","</div>",'<div  class="vipMightyValue">{{=item.startValue}}',"</div>",'<div class="upgradeFather">','<span class="upgradeLeft">{{=item.startValue}}',"</span>",'<div class="upgrade upgradeFinish">威武值已满',"</div>",'<span class="upgradeRight">{{=item.endValue}}',"</span>","</div>","</div>","</div>","{{~}}"].join("")),m=doT.template(["{{~it :item:index}}",'<div class="vipLeft">','<div class="vipLeftText">',"</div>",'<img src="{{=item.img}}" alt="" class="vipLeftImg">','<div class="vip" style="color:#fff;">等级说明',"</div>"," </div>",'<div class="canvasFather vfinsh">','<div class="vipMightyText vipMightyTextFinish">','<div class="vipMightySon" >',"<span>所需威武值","</span>","</div>",'<div  class="vipMightyValue">{{=item.poor}}',"</div>",'<div class="upgradeFather">','<span class="upgradeLeft">{{=item.startValue}}',"</span>",'<div class="upgrade upgradeFinish">加油',"</div>",'<span class="upgradeRight">{{=item.endValue}}',"</span>","</div>","</div>","</div>","{{~}}"].join(""));$.ajax({url:Setting.apiRoot1+"/u/queryMyVipPrivilege433.p2p",type:"post",dataType:"json",async:!1,data:{userId:userId,loginToken:loginToken}}).done(function(v){Common.ajaxDataFilter(v,function(){if(1!=v.code)return alert(v.message),!1;if(-1==v.code)return alert("查询失败"),!1;var g=v.data;a=g.defeatPercent,s=g.powerValue,e=g.vipRank,i=g.V0List,t=g.V1List,n=g.V2List,p=g.V3List,o=g.V4List,l=g.V5List;var h,y=$(".swiper-slide"),w=[];g.newVipId==g.oldVipId||g.newVipId>g.oldVipId?g.newOldVipFlag=1:g.newOldVipFlag=0;for(var f=0;f<=10;f++)if(f<e)I=f+1,w[0]={},w[0].startValue=g["V"+f+"Score"],w[0].endValue=g["V"+I+"Score"],w[0].img="../../images/pages/my-account3.0/exclusive/vip"+f+".png",y.eq(f).html(u(w));else if(f==e){I=1*e+1,w[0]={},w[0].powerValue=g.powerValue,w[0].startValue=g["V"+e+"Score"],w[0].VIPFinish=g.powerValue<g["V"+e+"Score"]?"V"+e:"VIP"+I,w[0].poor=1*g["V"+I+"Score"]-1*g.powerValue,w[0].defeatPercent=g.defeatPercent,w[0].img="../../images/pages/my-account3.0/exclusive/vip"+e+".png",y.eq(f).addClass("swiper-slideFinsh"),f>=10?(h=(1*g.powerValue-1*g["V"+e+"Score"])/(5e7-1*g["V"+e+"Score"]),w[0].endValue="+∞"):(h=(1*g.powerValue-1*g["V"+e+"Score"])/(1*g["V"+I+"Score"]-1*g["V"+e+"Score"]),w[0].endValue=g["V"+I+"Score"]),y.eq(f).html(r(w));for(var V=g["V"+e+"List"],T=0;T<V.length;T++)V[T].newOldVipFlag=g.newOldVipFlag,V[T].vipPrivilegeCount=g.vipPrivilegeCount;c.html(d(V))}else{var I=f+1;w[0]={},w[0].startValue=g["V"+f+"Score"],w[0].endValue=g["V"+I+"Score"],f>=10&&(w[0].endValue="+∞ "),w[0].poor=g["V"+f+"Score"],w[0].img="../../images/pages/my-account3.0/exclusive/vip"+f+".png",y.eq(f).html(m(w))}new Swiper(".swiper-container",{pagination:".swiper-pagination",slidesPerView:1,paginationClickable:!0,initialSlide:e,onSlideChangeEnd:function(a){vipIndex=a.activeIndex;var s=[];s=g["V"+vipIndex+"List"];for(var e=0;e<s.length;e++)s[e].newOldVipFlag=g.newOldVipFlag,s[e].vipPrivilegeCount=g.vipPrivilegeCount;c.html(d(s))}}),setTimeout(function(){var a=document.getElementById("vipMighty"),s=2*$(".canvasFather").width(),e=2*$(".canvasFather").height(),i=s/2.5,t=s/2,n=s/2;$(".vipMightyText").css({width:s/2,height:e/2}),a.setAttribute("width",s+"px"),a.setAttribute("height",s+"px"),$("#vipMighty").css({width:"100%",height:"100%"});var p=a.getContext("2d");p.strokeStyle="#F5EECB",p.lineWidth=10,p.lineCap="round",p.shadowBlur=30,p.shadowColor="#D8CA8F",p.arc(t,n,i,.75*Math.PI,.25*Math.PI,!1),p.stroke();var o=0,l=setInterval(function(){(o+=.01)>=1&&(o=1),o<=h?(p.beginPath(),p.clearRect(0,0,p.width,p.height),p.arc(t,n,i,.75*Math.PI,Math.PI*(.75+3*o/2),!1),p.strokeStyle="#82702E",p.shadowBlur=0,p.shadowColor="transparent",p.stroke(),p.closePath(),p.restore()):clearInterval(l)},10)},300)})}).fail(function(){alert("网络链接失败")}),$(".vwzinfo").on("click",function(){$ui_dialog.removeClass("hide"),$btn_default.attr("onclick",'$ui_dialog.addClass("hide");')}),$(".upgrade").on("click",function(){window.location.href="../../pages/financing/regular.html"}),$(".vip").on("click",function(){window.location.href="../../pages/my-account/level_instruction.html"}),$(".powerValue").html(s),$(".defeatPercent").html(a),5==e?$(".info2").html('您现在是最高级别，请保持欧<span class="upspan">&nbsp提高威武值</span>'):($(".nextRank").html(parseInt(e)+1),$(".shortof").html(parseFloat(void 0)-parseFloat(s))),$temporary=$(".temporary"),$full=$(".full"),$invite=$(".invite"),$temporary.on("click",function(){window.location.href="../../pages/my-account/rights-temporary.html"}),$full.on("click",function(){window.location.href="../../pages/my-account/rights-full.html"}),$invite.on("click",function(){window.location.href="../../pages/my-account/rights-invite.html"}),$(".myreward").on("click",function(){window.location.href="../../pages/my-account/reward/red-envelope.html"}),$(".upspan").on("click",function(){window.location.href="../../pages/financing/regular.html"}),$(".redbtn").on("click",function(){window.location.href="rewardCenter.html"}),$(".container").on("click",function(){window.location.href="rights-full.html"}),$(".redfalse").on("click",function(){$(".red-layer").css("display","none"),$(".mycash").html("￥"+cashredAmt);var a="";a=Math.random(),window.location.href=window.location.href+"?"+a}),$("#reloadbtn").on("click",function(){var a="";a=Math.random(),window.location.href=window.location.href+"?"+a,$(".alert-layer").css("display","none")})});